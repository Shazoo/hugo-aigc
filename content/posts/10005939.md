+++
title = "如何在Express应用程序中消费JSON POST数据"
slug = "如何在Express应用程序中消费JSON POST数据"
date = "2023-07-24T13:33:10+08:00"
tags = [ "json", "node.js", "express",]
thumbnail = "/images/json.256x256.png"
featureImage = "/images/json.256x256.png"
+++


> 本教程将介绍如何在Express应用程序中消费JSON POST数据。你将学习如何解析请求正文，以获取JSON数据。

## 摘要

当你在Express应用程序中收到JSON字符串的POST请求时，你想要访问请求的正文内容。本教程将向你展示如何在Express中实现这一目标。

## 内容

在服务器端，你可以使用`bodyParser`中间件解析请求正文，并将结果放入`request.body`中。如果你使用的是有效的JSON，并使用`Content-Type: application/json`发送POST请求，那么你可以按照下面的步骤来获取请求正文中的JSON数据。

### 安装`bodyParser`

在Express 4及以上版本中，你可以使用内置的`express.json()`中间件来解析JSON数据。而在Express 4.0至4.15版本中，`bodyParser`是独立的npm包，需要单独安装。以下是安装步骤：

```
$ npm install body-parser
```

### 使用`express.json()`中间件（Express 4.16+）

```javascript
var express = require('express');
var app = express();

app.use(express.json());

app.post('/', function(request, response){
  console.log(request.body);      // 输出JSON数据
  response.send(request.body);    // 将结果返回给客户端
});

app.listen(3000);
```

### 使用`bodyParser.json()`中间件（Express 4.0 - 4.15）

如果你使用的是Express 4.0至4.15版本，请使用以下示例代码：

```javascript
var express = require('express');
var bodyParser = require('body-parser');
var app = express();

app.use(bodyParser.json());

app.post('/', function(request, response){
  console.log(request.body);      // 输出JSON数据
  response.send(request.body);    // 将结果返回给客户端
});

app.listen(3000);
```

### 使用`express.bodyParser()`中间件（Express < 4）

如果你使用的是Express 4版本之前的早期版本，请使用以下示例代码：

```javascript
var express = require('express');
var app = express.createServer();

app.use(express.bodyParser());

app.post('/', function(request, response){
  console.log(request.body);      // 输出JSON数据
  response.send(request.body);    // 将结果返回给客户端
});

app.listen(3000);
```

### 测试

你可以使用curl命令进行测试，按照以下示例发送POST请求，并查看控制台输出：

```
$ curl -d '{"MyKey":"My Value"}' -H "Content-Type: application/json" http://127.0.0.1:3000/
{"MyKey":"My Value"}
```

## 总结

通过本教程，你了解了如何在Express应用程序中消费JSON POST数据。现在你可以使用合适的中间件来解析请求正文，并获取其中的JSON数据。


